---
layout: post
title: 'Как Python выполняет программы'
category: python
---


Когда вы инструктируете Python относительно выполнения сценария, то перед тем, как ваш код начнет перемалывание чисел, Python предпринимает несколько ша­ гов. В частности, первым делом он осуществляет компиляцию сценария в то, что на­ зывается “байт-кодом”, и направляет его так называемой “виртуальной машине”.

## 1. Компиляция в байт-код
После запуска программы Python внутренне и почти полностью скрыто от вас сна­ чала компилирует ваш исходный код (операторы внутри файла) в формат, известный как байт-код. Компиляция является просто шагом трансляции, а байт-код — это низко­ уровневое и независимое от платформы представление исходного кода. Грубо говоря, Python транслирует каждый оператор исходного кода в группу инструкций байт-кода, разбивая их на отдельные шаги.

Если процесс Python имеет доступ по записи на ва­ шем компьютере, тогда он будет сохранять программы в файлах с расширением .рус (означает скомпилированный (compiled) исходный файл ```.ру```). До выхода версии Python 3.2 эти файлы появлялись на компьютере после запуска нескольких программ там, где находились соответствующие файлы исходного кода, т.е. в тех же самых ката­
логах. Например, после импортирования ```script.ру``` появлялся файл ```script.рус```.
В Python 3.2 и последующих версиях файлы байт-кода ```.рус``` взамен сохраняются в подкаталоге по имени ```__ pycache__```, расположенном в каталоге, где находятся файлы
исходного кода.

Python сохраняет байт-код подобного рода в качестве оптимиза­ ции скорости начального загрузки. Во время следующего запуска программы Python загрузит файлы .рус и пропустит шаг компиляции при условии, что вы не изменяли исходный код после того, как байт-код был сохранен, и не выполняете версию Python, отличающуюся от той.

## 2. Виртуальная машина Python (PVM)
После того, как программа скомпилирована в байт-код (или байт-код был загру­ жен из существующих файлов ```.рус```), она отправляется на выполнение тому, что в общем случае известно как виртуальная машина Python (Python Virtual Machine — PVM). Машина PVM производит более глубокое впечатление, чем есть на самом деле; в действительности она не является отдельной программой и сама по себе не требует установки. По сути, машина PVM — всего лишь большой закодированный цикл, кото­ рый проходит по инструкциям вашего байт-кода, друг за другом, чтобы выполнить их операции. Машина PVM — это исполняющий механизм Python; она всегда присутству­ ет в виде части системы Python и представляет собой компонент, который по-насто­ ящему выполняет ваши сценарии. Формально она является просто последним шагом того, что называется “интерпретатор Python”.

<img src="/assets/img/2020-06-02-kak-python-vypolniaet-programmy/1.png">